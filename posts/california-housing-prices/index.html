<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="An introductory-level regression using California housing data.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>California Housing Prices | Machine Learning Studies</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<link rel="canonical" href="http://necromuralist.github.io/machine-learning-studies/posts/california-housing-prices/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script><meta name="author" content="necromuralist">
<link rel="prev" href="../decision-tree-classification/" title="Decision Tree Classification" type="text/html">
<link rel="next" href="../references/" title="References" type="text/html">
<meta property="og:site_name" content="Machine Learning Studies">
<meta property="og:title" content="California Housing Prices">
<meta property="og:url" content="http://necromuralist.github.io/machine-learning-studies/posts/california-housing-prices/">
<meta property="og:description" content="An introductory-level regression using California housing data.">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2018-07-30T16:54:39-07:00">
<meta property="article:tag" content="regression basics">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-default navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://necromuralist.github.io/machine-learning-studies/">

                <span id="blog-title">Machine Learning Studies</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="https://necromuralist.github.io/">The Cloistered Monkey</a>
                </li>
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>
                </li>
<li>
<a href="../../rss.xml">RSS feed</a>

                
            </li>
</ul>
<!-- Google custom search --><form method="get" action="https://www.google.com/search" class="navbar-form navbar-right" role="search">
<div class="form-group">
<input type="text" name="q" class="form-control" placeholder="Search">
</div>
<button type="submit" class="btn btn-primary">
	<span class="glyphicon glyphicon-search"></span>
</button>
<input type="hidden" name="sitesearch" value="http://necromuralist.github.io/machine-learning-studies/">
</form>
<!-- End of custom search -->


            <ul class="nav navbar-nav navbar-right">
<li>
    <a href="index.org" id="sourcelink">Source</a>
    </li>

                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">California Housing Prices</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                    <a href="../../authors/necromuralist/">necromuralist</a>
            </span></p>
            <p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2018-07-30T16:54:39-07:00" itemprop="datePublished" title="2018-07-30 16:54">2018-07-30 16:54</time></a></p>
            
        <p class="sourceline"><a href="index.org" class="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgd04686a">Introduction</a></li>
<li><a href="#orgb64c071">Imports</a></li>
<li><a href="#org4f6894c">Constants</a></li>
<li><a href="#org8ae08d1">The Data</a></li>
<li><a href="#org0317cef">References</a></li>
</ul>
</div>
</div>
<div id="outline-container-orgd04686a" class="outline-2">
<h2 id="orgd04686a">Introduction</h2>
<div class="outline-text-2" id="text-orgd04686a">
<p>
This is an introductory regression problem that uses California housing data from the 1990 census. There's a description of the original data <a href="https://www.dcc.fc.up.pt/~ltorgo/Regression/cal_housing.htm">here</a>, but we're using a slightly altered dataset that's <a href="https://github.com/ageron/handson-ml/tree/master/datasets/housing">on github</a> (and appears to be mirrored <a href="https://www.kaggle.com/camnugent/california-housing-prices">on kaggle</a>). The problem here is to create a model that will predict the median housing value for a census block group (called "district" in the dataset) given the other attributes.
</p>
</div>
</div>

<div id="outline-container-orgb64c071" class="outline-2">
<h2 id="orgb64c071">Imports</h2>
<div class="outline-text-2" id="text-orgb64c071">
<p>
These are the dependencies for this problem.
</p>

<div class="highlight"><pre><span></span># python standard library
import os
import tarfile
import warnings
warnings.filterwarnings("ignore", message="numpy.dtype size changed")
from http import HTTPStatus

# from pypi
import matplotlib
import pandas
import requests
import seaborn
from tabulate import tabulate
</pre></div>
</div>
</div>

<div id="outline-container-org4f6894c" class="outline-2">
<h2 id="org4f6894c">Constants</h2>
<div class="outline-text-2" id="text-org4f6894c">
<p>
These are convenience holders for strings and other constants so they don't get scattered all over the place.
</p>

<div class="highlight"><pre><span></span>class Data:
    source_slug = "../data/california-housing-prices/"
    target_slug = "../data_temp/california-housing-prices/"
    url = "https://github.com/ageron/handson-ml/raw/master/datasets/housing/housing.tgz"
    source = source_slug + "housing.tgz"
    target = target_slug + "housing.csv"
    chunk_size = 128
</pre></div>
</div>
</div>
<div id="outline-container-org8ae08d1" class="outline-2">
<h2 id="org8ae08d1">The Data</h2>
<div class="outline-text-2" id="text-org8ae08d1">
<p>
We'll grab the data from github, extract it (it's a <code>tgz</code> compressed tarfile), then make a pandas data frame from it.
</p>
</div>
<div id="outline-container-org00b7cb0" class="outline-3">
<h3 id="org00b7cb0">Downloading and uncompressing the data</h3>
<div class="outline-text-3" id="text-org00b7cb0">
<div class="highlight"><pre><span></span>def get_data():
    """Gets the data from github and uncompresses it"""
    if os.path.exists(Data.target):
	return

    os.makedirs(Data.target_slug, exist_ok=True)
    os.makedirs(Data.source_slug, exist_ok=True)
    response = requests.get(Data.url, stream=True)
    assert response.status_code == HTTPStatus.OK
    with open(Data.source, "wb") as writer:
	for chunk in response.iter_content(chunk_size=Data.chunk_size):
	    writer.write(chunk)
    assert os.path.exists(Data.source)
    compressed = tarfile.open(Data.source)
    compressed.extractall(Data.target_slug)
    compressed.close()
    assert os.path.exists(Data.target)
    return
</pre></div>


<p>
Contents of ../data_temp/california-housing-prices/:
</p>
<ul class="org-ul">
<li>housing.csv</li>
</ul>
</div>
</div>
<div id="outline-container-orgb44f9b5" class="outline-3">
<h3 id="orgb44f9b5">Building the dataframe</h3>
<div class="outline-text-3" id="text-orgb44f9b5">
<div class="highlight"><pre><span></span>housing = pandas.read_csv(Data.target)
</pre></div>

<pre class="example">
&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 20640 entries, 0 to 20639
Data columns (total 10 columns):
longitude             20640 non-null float64
latitude              20640 non-null float64
housing_median_age    20640 non-null float64
total_rooms           20640 non-null float64
total_bedrooms        20433 non-null float64
population            20640 non-null float64
households            20640 non-null float64
median_income         20640 non-null float64
median_house_value    20640 non-null float64
ocean_proximity       20640 non-null object
dtypes: float64(9), object(1)
memory usage: 1.6+ MB
None
</pre>

<p>
If you look at the <code>total_bedrooms</code> count you'll see that it only has 20,433 non-null values, while the rest of the columns have 20,640 values. These were removed to allow experimenting with missing data. The original dataset that was collected for the census had all the values.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-left">
<col class="org-left">
</colgroup>
<thead><tr>
<th scope="col" class="org-left">Column</th>
<th scope="col" class="org-left">Has Missing Values</th>
</tr></thead>
<tbody>
<tr>
<td class="org-left">longitude</td>
<td class="org-left">False</td>
</tr>
<tr>
<td class="org-left">latitude</td>
<td class="org-left">False</td>
</tr>
<tr>
<td class="org-left">housing_median_age</td>
<td class="org-left">False</td>
</tr>
<tr>
<td class="org-left">total_rooms</td>
<td class="org-left">False</td>
</tr>
<tr>
<td class="org-left">total_bedrooms</td>
<td class="org-left">True</td>
</tr>
<tr>
<td class="org-left">population</td>
<td class="org-left">False</td>
</tr>
<tr>
<td class="org-left">households</td>
<td class="org-left">False</td>
</tr>
<tr>
<td class="org-left">median_income</td>
<td class="org-left">False</td>
</tr>
<tr>
<td class="org-left">median_house_value</td>
<td class="org-left">False</td>
</tr>
<tr>
<td class="org-left">ocean_proximity</td>
<td class="org-left">False</td>
</tr>
</tbody>
</table>
<p>
It looks like <code>total_bedrooms</code> is the only column where there's missing data.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-right">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-right">Rows</th>
<th scope="col" class="org-right">Columns</th>
</tr></thead>
<tbody><tr>
<td class="org-right">20640</td>
<td class="org-right">10</td>
</tr></tbody>
</table>
<p>
I'll print the median for each column except the last (since it's non-numeric).
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-right">longitude</th>
<th scope="col" class="org-right">latitude</th>
<th scope="col" class="org-right">housing_median_age</th>
<th scope="col" class="org-right">total_rooms</th>
</tr></thead>
<tbody><tr>
<td class="org-right">-118.49</td>
<td class="org-right">34.26</td>
<td class="org-right">29.00</td>
<td class="org-right">2127.00</td>
</tr></tbody>
</table>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-right">total_bedrooms</th>
<th scope="col" class="org-right">population</th>
<th scope="col" class="org-right">households</th>
<th scope="col" class="org-right">median_income</th>
<th scope="col" class="org-right">median_house_value</th>
</tr></thead>
<tbody><tr>
<td class="org-right">435.00</td>
<td class="org-right">1166.00</td>
<td class="org-right">409.00</td>
<td class="org-right">3.53</td>
<td class="org-right">179700.00</td>
</tr></tbody>
</table>
<p>
Here's the description for the <code>ocean_proximity</code> variable
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-left">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-left">Statistic</th>
<th scope="col" class="org-right">Value</th>
</tr></thead>
<tbody>
<tr>
<td class="org-left">count</td>
<td class="org-right">20640</td>
</tr>
<tr>
<td class="org-left">unique</td>
<td class="org-right">5</td>
</tr>
<tr>
<td class="org-left">top</td>
<td class="org-right">&lt;1H OCEAN</td>
</tr>
<tr>
<td class="org-left">freq</td>
<td class="org-right">9136</td>
</tr>
</tbody>
</table>
<p>
It looks like the most common house location is less than an hour from the ocean.
</p>

<div class="highlight"><pre><span></span>print(
    "{:.2f}".format(
	ocean_proximity_description.loc["freq"]/ocean_proximity_description.loc["count"]))
</pre></div>

<p>
0.44
</p>

<p>
Which makes up about forty-four percent of all the houses. Here are all the <code>ocean_proximity</code> values.
</p>


<div class="figure">
<p><img src="ocean_proximity.png" alt="ocean_proximity.png"></p>
</div>


<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-left">
<col class="org-right">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-left">Proximity</th>
<th scope="col" class="org-right">Count</th>
<th scope="col" class="org-right">Percentage</th>
</tr></thead>
<tbody>
<tr>
<td class="org-left">&lt;1H OCEAN</td>
<td class="org-right">9136</td>
<td class="org-right">44.2636</td>
</tr>
<tr>
<td class="org-left">INLAND</td>
<td class="org-right">6551</td>
<td class="org-right">31.7393</td>
</tr>
<tr>
<td class="org-left">NEAR OCEAN</td>
<td class="org-right">2658</td>
<td class="org-right">12.8779</td>
</tr>
<tr>
<td class="org-left">NEAR BAY</td>
<td class="org-right">2290</td>
<td class="org-right">11.095</td>
</tr>
<tr>
<td class="org-left">ISLAND</td>
<td class="org-right">5</td>
<td class="org-right">0.0242248</td>
</tr>
</tbody>
</table>
<div class="figure">
<p><img src="housing_histogram.png" alt="housing_histogram.png"></p>
</div>
</div>
</div>
</div>

<div id="outline-container-org0317cef" class="outline-2">
<h2 id="org0317cef">References</h2>
<div class="outline-text-2" id="text-org0317cef">
<ul class="org-ul">
<li>Géron, Aurélien. Hands-on Machine Learning with Scikit-Learn and TensorFlow: Concepts, Tools, and Techniques to Build Intelligent Systems. First edition. Beijing Boston Farnham: O’Reilly, 2017.</li>
</ul>
</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/regression-basics/" rel="tag">regression basics</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../decision-tree-classification/" rel="prev" title="Decision Tree Classification">Previous post</a>
            </li>
            <li class="next">
                <a href="../references/" rel="next" title="References">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2018         <a href="mailto:necromuralist@gmail.com">necromuralist</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png"></a><br>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
