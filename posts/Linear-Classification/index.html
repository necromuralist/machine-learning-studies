<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Introduction to Linear Classifiers">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Linear Classification | Machine Learning Studies</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<link rel="canonical" href="http://necromuralist.github.io/machine-learning-studies/posts/Linear-Classification/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script><meta name="author" content="necromuralist">
<link rel="prev" href="../linear-models/" title="Linear Models" type="text/html">
<link rel="next" href="../Naive-Bayes-Classification/" title="Naive Bayes Classification" type="text/html">
<meta property="og:site_name" content="Machine Learning Studies">
<meta property="og:title" content="Linear Classification">
<meta property="og:url" content="http://necromuralist.github.io/machine-learning-studies/posts/Linear-Classification/">
<meta property="og:description" content="Introduction to Linear Classifiers">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2017-07-13T12:38:00-07:00">
<meta property="article:tag" content="classification">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-default navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://necromuralist.github.io/machine-learning-studies/">

                <span id="blog-title">Machine Learning Studies</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>
                </li>
<li>
<a href="../../rss.xml">RSS feed</a>

                
            </li>
</ul>
<!-- Google custom search --><form method="get" action="https://www.google.com/search" class="navbar-form navbar-right" role="search">
<div class="form-group">
<input type="text" name="q" class="form-control" placeholder="Search">
</div>
<button type="submit" class="btn btn-primary">
	<span class="glyphicon glyphicon-search"></span>
</button>
<input type="hidden" name="sitesearch" value="http://necromuralist.github.io/machine-learning-studies/">
</form>
<!-- End of custom search -->


            <ul class="nav navbar-nav navbar-right">
<li>
    <a href="index.rst" id="sourcelink">Source</a>
    </li>

                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Linear Classification</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                    <a href="../../authors/necromuralist/">necromuralist</a>
            </span></p>
            <p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2017-07-13T12:38:00-07:00" itemprop="datePublished" title="2017-07-13 12:38">2017-07-13 12:38</time></a></p>
            
        <p class="sourceline"><a href="index.rst" class="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<div class="section" id="imports">
<h2>1 Imports</h2>
<pre class="code python"><a name="rest_code_3c2774180a104082a9a7a5b243cbe3c8-1"></a><span class="kn">import</span> <span class="nn">pandas</span>
<a name="rest_code_3c2774180a104082a9a7a5b243cbe3c8-2"></a><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<a name="rest_code_3c2774180a104082a9a7a5b243cbe3c8-3"></a><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_breast_cancer</span>
<a name="rest_code_3c2774180a104082a9a7a5b243cbe3c8-4"></a><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<a name="rest_code_3c2774180a104082a9a7a5b243cbe3c8-5"></a><span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">LinearSVC</span>
</pre>
</div>
<div class="section" id="the-data">
<h2>2 The Data</h2>
<pre class="code python"><a name="rest_code_5bcb38b866d94c9eb195f5ecbe59579e-1"></a><span class="n">cancer</span> <span class="o">=</span> <span class="n">load_breast_cancer</span><span class="p">()</span>
<a name="rest_code_5bcb38b866d94c9eb195f5ecbe59579e-2"></a><span class="k">print</span><span class="p">(</span><span class="n">cancer</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre>
<pre class="literal-block">
dict_keys(['target_names', 'feature_names', 'data', 'DESCR', 'target'])
</pre>
<pre class="code python"><a name="rest_code_2d347b65d89f422d802d7e74eb5adf5e-1"></a><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">cancer</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
<a name="rest_code_2d347b65d89f422d802d7e74eb5adf5e-2"></a>                                                    <span class="n">cancer</span><span class="o">.</span><span class="n">target</span><span class="p">,</span>
<a name="rest_code_2d347b65d89f422d802d7e74eb5adf5e-3"></a>                                                    <span class="n">stratify</span><span class="o">=</span><span class="n">cancer</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>
</pre>
</div>
<div class="section" id="logistic-regression">
<h2>3 Logistic Regression</h2>
<pre class="code python"><a name="rest_code_9f3435f5abc0437f926ab1f6b469c359-1"></a><span class="n">logistic_model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">penalty</span><span class="o">=</span><span class="s2">"l1"</span><span class="p">)</span>
<a name="rest_code_9f3435f5abc0437f926ab1f6b469c359-2"></a><span class="n">logistic_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<a name="rest_code_9f3435f5abc0437f926ab1f6b469c359-3"></a><span class="k">print</span><span class="p">(</span><span class="s2">"Logistic Training Accuracy: {:.2f}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">logistic_model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)))</span>
<a name="rest_code_9f3435f5abc0437f926ab1f6b469c359-4"></a><span class="k">print</span><span class="p">(</span><span class="s2">"Logistic Testing Accuracy: {:.2f}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">logistic_model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)))</span>
</pre>
<pre class="literal-block">
Logistic Training Accuracy: 0.97
Logistic Testing Accuracy: 0.92
</pre>
<p>Depending on the random seed it sometimes does better on the testing than it does on the training set.</p>
<pre class="code python"><a name="rest_code_314a2a2bed634f81919206cba0808bf3-1"></a><span class="n">coefficients</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">logistic_model</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">cancer</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>
<a name="rest_code_314a2a2bed634f81919206cba0808bf3-2"></a><span class="k">print</span><span class="p">(</span><span class="n">coefficients</span><span class="p">)</span>
</pre>
<pre class="literal-block">
mean radius                2.257338
mean texture               0.058581
mean perimeter            -0.001644
mean area                 -0.009889
mean smoothness            0.000000
mean compactness           0.000000
mean concavity             0.000000
mean concave points        0.000000
mean symmetry              0.000000
mean fractal dimension     0.000000
radius error               0.000000
texture error              2.657975
perimeter error            0.000000
area error                -0.118846
smoothness error           0.000000
compactness error          0.000000
concavity error            0.000000
concave points error       0.000000
symmetry error             0.000000
fractal dimension error    0.000000
worst radius               1.635063
worst texture             -0.412327
worst perimeter           -0.201013
worst area                -0.022727
worst smoothness           0.000000
worst compactness          0.000000
worst concavity           -4.246229
worst concave points       0.000000
worst symmetry             0.000000
worst fractal dimension    0.000000
dtype: float64
</pre>
<pre class="code python"><a name="rest_code_4655df8d3ba9420ea73001e2faf51cd6-1"></a><span class="n">features</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cancer</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>
<a name="rest_code_4655df8d3ba9420ea73001e2faf51cd6-2"></a><span class="n">non_zero</span> <span class="o">=</span> <span class="n">coefficients</span><span class="p">[</span><span class="n">coefficients</span><span class="o">!=</span><span class="mi">0</span><span class="p">]</span>
<a name="rest_code_4655df8d3ba9420ea73001e2faf51cd6-3"></a><span class="k">print</span><span class="p">(</span><span class="n">non_zero</span><span class="p">)</span>
<a name="rest_code_4655df8d3ba9420ea73001e2faf51cd6-4"></a><span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">non_zero</span><span class="p">)</span><span class="o">/</span><span class="n">features</span><span class="p">)</span>
</pre>
<pre class="literal-block">
mean radius        2.257338
mean texture       0.058581
mean perimeter    -0.001644
mean area         -0.009889
texture error      2.657975
area error        -0.118846
worst radius       1.635063
worst texture     -0.412327
worst perimeter   -0.201013
worst area        -0.022727
worst concavity   -4.246229
dtype: float64
0.36666666666666664
</pre>
<p>The model was able to remove 37% of the features.</p>
<pre class="code python"><a name="rest_code_f4d4718a9b6c4dbdae0c2a685ce8915e-1"></a><span class="n">model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<a name="rest_code_f4d4718a9b6c4dbdae0c2a685ce8915e-2"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<a name="rest_code_f4d4718a9b6c4dbdae0c2a685ce8915e-3"></a><span class="k">print</span><span class="p">(</span><span class="s2">"Training Accuracy: {0:.2f}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)))</span>
<a name="rest_code_f4d4718a9b6c4dbdae0c2a685ce8915e-4"></a><span class="k">print</span><span class="p">(</span><span class="s2">"Testing Accuracy: {0:.2f}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)))</span>
</pre>
<pre class="literal-block">
Training Accuracy: 0.98
Testing Accuracy: 0.95
</pre>
<p>Using an <em>L2</em> penalty of 100 improves the accuracy of the model. Increasing "C" means less regularization, so in this case the improvement came from using a more complex model.</p>
</div>
<div class="section" id="support-vector-machine-classification">
<h2>4 Support Vector Machine Classification</h2>
<pre class="code python"><a name="rest_code_21f1f2d452b24838b0c42a6122e18a3c-1"></a><span class="k">for</span> <span class="n">power</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
<a name="rest_code_21f1f2d452b24838b0c42a6122e18a3c-2"></a>    <span class="n">penalty</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="n">power</span>
<a name="rest_code_21f1f2d452b24838b0c42a6122e18a3c-3"></a>    <span class="n">svc</span> <span class="o">=</span> <span class="n">LinearSVC</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="n">penalty</span><span class="p">)</span>
<a name="rest_code_21f1f2d452b24838b0c42a6122e18a3c-4"></a>    <span class="n">svc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<a name="rest_code_21f1f2d452b24838b0c42a6122e18a3c-5"></a>    <span class="k">print</span><span class="p">(</span><span class="s2">"C={}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">penalty</span><span class="p">))</span>
<a name="rest_code_21f1f2d452b24838b0c42a6122e18a3c-6"></a>    <span class="k">print</span><span class="p">(</span><span class="s2">"Training Accuracy: {0:.2f}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">svc</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)))</span>
<a name="rest_code_21f1f2d452b24838b0c42a6122e18a3c-7"></a>    <span class="k">print</span><span class="p">(</span><span class="s2">"Testing Accuracy: {0:.2f}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">svc</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)))</span>
<a name="rest_code_21f1f2d452b24838b0c42a6122e18a3c-8"></a>    <span class="k">print</span><span class="p">()</span>
</pre>
<pre class="literal-block">
C=0.0001
Training Accuracy: 0.93
Testing Accuracy: 0.93

C=0.001
Training Accuracy: 0.93
Testing Accuracy: 0.92

C=0.01
Training Accuracy: 0.70
Testing Accuracy: 0.71

C=0.1
Training Accuracy: 0.94
Testing Accuracy: 0.93

C=1
Training Accuracy: 0.92
Testing Accuracy: 0.92

C=10
Training Accuracy: 0.93
Testing Accuracy: 0.94

C=100
Training Accuracy: 0.86
Testing Accuracy: 0.84

C=1000
Training Accuracy: 0.92
Testing Accuracy: 0.92
</pre>
<p>Every time I run this it comes out slightly differently, but it seems like most values do pretty well, there's usually only one or two values of <em>C</em> below 0.92 for the test set.</p>
</div>
<div class="section" id="tuning-the-penalty">
<h2>5 Tuning the Penalty</h2>
<p>The L1 penalty makes use of more of the features so it will generally do better if they are all relevant. The L2 penalty is better for interpreting the important features and will do better if some of the features are in fact not relevant. Unlike <em>alpha</em> for regression, <em>C</em> decreases the regularization as it gets bigger. When searching for the best value it can be useful to search a logarithmic space (e.g. 0.001, 0.01, 0.1, 1, 10, 100)</p>
</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/classification/" rel="tag">classification</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../linear-models/" rel="prev" title="Linear Models">Previous post</a>
            </li>
            <li class="next">
                <a href="../Naive-Bayes-Classification/" rel="next" title="Naive Bayes Classification">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2018         <a href="mailto:necromuralist@gmail.com">necromuralist</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png"></a><br>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
